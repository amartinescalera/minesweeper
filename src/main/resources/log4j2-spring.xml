<?xml version="1.0" encoding="UTF-8"?>
<Configuration>

    <Properties>
        <Property name="appName">springDemo</Property>
    </Properties>

    <Appenders>

        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ} [%t] %-5level %logger{36} %X{USER} %msg %n" />
        </Console>

        <RollingRandomAccessFile name="JSON_FILE"
                                 fileName="${env:HOME}/logs/springDemo/application-spring-demo.json.log"
                                 filePattern="${env:HOME}/logs/springDemo/application-spring-demo-%d{MM-dd-yyyy}-%i.json.log.gz">

            <ThresholdFilter level="INFO" />

            <JsonLayout complete="false"  compact="true" eventEol="true">
                <KeyValuePair key="timestamp" value="$${date:yyyy-MM-dd'T'HH:mm:ss.SSSZ}" />
                <KeyValuePair key="response" value="$${ctx:RESPONSE}" />
                <KeyValuePair key="userAgent" value="$${ctx:USER-AGENT}" />
            </JsonLayout>

            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="100 MB" />
            </Policies>
        </RollingRandomAccessFile>

    </Appenders>

    <Loggers>
        <!-- LOG everything at INFO level -->
        <Logger name="info.antoniomartin" level="WARN" />
        <Logger name="org.springframework" level="WARN" />

        <Root level="WARN">
            <AppenderRef ref="JSON_FILE" />
            <AppenderRef ref="Console" />
        </Root>
    </Loggers>

</Configuration>
